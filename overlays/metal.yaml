# Basic overlay for Metal API normalization
overlay: "1.0.0"
info:
  title: "Overlay for Metal API"
  version: "1.0.0"
  description: "Overlay spec to normalize Metal API for merging"

actions:
  # Normalize the title
  - target: "$.info.title"
    update: "Equinix Metal API"
    
  # Standardize servers to use common base URL
  - target: "$.servers"
    update:
      - url: "https://api.equinix.com"
        description: "Equinix API Server"
        
  # Ensure all paths start with /metal/v1
  - target: "$.paths"
    transform: "prefix_paths"
    options:
      prefix: "/metal/v1"
      
  # Add consistent tags
  - target: "$.paths.*.*.tags"
    update: ["metal"]
    merge: true
    
  # Normalize authentication
  - target: "$.components.securitySchemes"
    update:
      MetalToken:
        type: "apiKey"
        in: "header"
        name: "X-Auth-Token"
        description: "Metal API authentication token"
        
  # Set default security
  - target: "$.security"
    update:
      - MetalToken: []